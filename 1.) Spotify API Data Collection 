{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "c0d7f32e",
   "metadata": {},
   "source": [
    "# Collecting Our Data\n",
    "\n",
    "**Disclaimer:** This notebook is for learning purposes only, attempting to re-run these cells will use my API key, which if makes too many requests, may be banned from pulling from the API.\n",
    "\n",
    "To get your own developer key, please follow [this link](https://developer.spotify.com/documentation/web-api) to create a Spotify developer account. Replace your credentials into the designated stored attributes. You only need to do this if you wish to save a copy of the csv data onto your local computer."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "107f7b05",
   "metadata": {},
   "source": [
    "### Necessary Libraries & Initializing Client Credentials"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "0f0e2a04",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: spotipy in /Users/youssefagour/anaconda3/lib/python3.11/site-packages (2.23.0)\n",
      "Requirement already satisfied: redis>=3.5.3 in /Users/youssefagour/anaconda3/lib/python3.11/site-packages (from spotipy) (5.0.3)\n",
      "Requirement already satisfied: requests>=2.25.0 in /Users/youssefagour/anaconda3/lib/python3.11/site-packages (from spotipy) (2.31.0)\n",
      "Requirement already satisfied: six>=1.15.0 in /Users/youssefagour/anaconda3/lib/python3.11/site-packages (from spotipy) (1.16.0)\n",
      "Requirement already satisfied: urllib3>=1.26.0 in /Users/youssefagour/anaconda3/lib/python3.11/site-packages (from spotipy) (1.26.16)\n",
      "Requirement already satisfied: async-timeout>=4.0.3 in /Users/youssefagour/anaconda3/lib/python3.11/site-packages (from redis>=3.5.3->spotipy) (4.0.3)\n",
      "Requirement already satisfied: charset-normalizer<4,>=2 in /Users/youssefagour/anaconda3/lib/python3.11/site-packages (from requests>=2.25.0->spotipy) (2.0.4)\n",
      "Requirement already satisfied: idna<4,>=2.5 in /Users/youssefagour/anaconda3/lib/python3.11/site-packages (from requests>=2.25.0->spotipy) (3.4)\n",
      "Requirement already satisfied: certifi>=2017.4.17 in /Users/youssefagour/anaconda3/lib/python3.11/site-packages (from requests>=2.25.0->spotipy) (2023.7.22)\n"
     ]
    }
   ],
   "source": [
    "!pip install spotipy\n",
    "import spotipy\n",
    "from spotipy.oauth2 import SpotifyClientCredentials\n",
    "import pandas as pd\n",
    "import time"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "8c3637ea",
   "metadata": {},
   "outputs": [],
   "source": [
    "# My unique Client ID\n",
    "CLIENT_ID = '' # Hidden\n",
    "CLIENT_SECRET = '' # Hidden\n",
    "\n",
    "# Running through Spotipy functions to validate API requests\n",
    "client_credentials_manager = SpotifyClientCredentials(client_id=CLIENT_ID, client_secret=CLIENT_SECRET)\n",
    "sp = spotipy.Spotify(client_credentials_manager=client_credentials_manager)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1e58cc09",
   "metadata": {},
   "source": [
    "### Extracting Data on 2023's most popular songs from the Spotify Official Playlist"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "b5fcc467",
   "metadata": {},
   "outputs": [],
   "source": [
    "artist_name = []\n",
    "track_name = []\n",
    "track_popularity = []\n",
    "artist_id = []\n",
    "track_id = []\n",
    "\n",
    "# Retrieve tracks from the top 2023 playlist\n",
    "track_results = sp.playlist(playlist_id='37i9dQZF1DX18jTM2l2fJY')\n",
    "\n",
    "# Iterate over each track in the playlist\n",
    "for track_item in track_results['tracks']['items']:\n",
    "    # Retrieve track id details\n",
    "    track = track_item['track']\n",
    "    \n",
    "    # Extract track particulars\n",
    "    artist_name.append(track['artists'][0]['name'])\n",
    "    artist_id.append(track['artists'][0]['id'])\n",
    "    track_name.append(track['name'])\n",
    "    track_id.append(track['id'])\n",
    "    track_popularity.append(track['popularity'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "11693072",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(50, 5)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>artist_name</th>\n",
       "      <th>track_name</th>\n",
       "      <th>track_id</th>\n",
       "      <th>track_popularity</th>\n",
       "      <th>artist_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Eslabon Armado</td>\n",
       "      <td>Ella Baila Sola</td>\n",
       "      <td>3qQbCzHBycnDpGskqOWY0E</td>\n",
       "      <td>79</td>\n",
       "      <td>0XeEobZplHxzM9QzFQWLiR</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Sam Smith</td>\n",
       "      <td>Unholy (feat. Kim Petras)</td>\n",
       "      <td>0NZPBYD5qbEWRs3PrGiRkT</td>\n",
       "      <td>78</td>\n",
       "      <td>2wY79sveU1sp5g7SokKOiI</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Rema</td>\n",
       "      <td>Calm Down (with Selena Gomez)</td>\n",
       "      <td>1s7oOCT8vauUh01PbJD6ps</td>\n",
       "      <td>77</td>\n",
       "      <td>46pWGuE3dSwY3bMMXGBvVS</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>Yandel</td>\n",
       "      <td>Yandel 150</td>\n",
       "      <td>4FAKtPVycI4DxoOHC01YqD</td>\n",
       "      <td>77</td>\n",
       "      <td>0eHQ9o50hj6ZDNBt6Ys1sD</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>39</th>\n",
       "      <td>Bad Bunny</td>\n",
       "      <td>WHERE SHE GOES</td>\n",
       "      <td>2sTDlCxmuZCTDKKk9f1qus</td>\n",
       "      <td>75</td>\n",
       "      <td>4q3ewBCX7sLwd24euuV69X</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>44</th>\n",
       "      <td>Peso Pluma</td>\n",
       "      <td>PRC</td>\n",
       "      <td>0cNSq9T5l8gZnpY14rsTR2</td>\n",
       "      <td>75</td>\n",
       "      <td>12GqGscKJx3aE4t07u7eVZ</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37</th>\n",
       "      <td>Taylor Swift</td>\n",
       "      <td>Blank Space</td>\n",
       "      <td>1p80LdxRV74UKvL8gnD7ky</td>\n",
       "      <td>74</td>\n",
       "      <td>06HL4z0CvFAxyc27GXpf02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>PinkPantheress</td>\n",
       "      <td>Boy's a liar Pt. 2</td>\n",
       "      <td>5CCr8msaN3MhgqBoa9yWhH</td>\n",
       "      <td>74</td>\n",
       "      <td>78rUTD7y6Cy67W1RVzYs7t</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>48</th>\n",
       "      <td>Natanael Cano</td>\n",
       "      <td>AMG</td>\n",
       "      <td>0FxtC8uFapbpDBliAU3sd6</td>\n",
       "      <td>73</td>\n",
       "      <td>0elWFr7TW8piilVRYJUe4P</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>FIFTY FIFTY</td>\n",
       "      <td>Cupid - Twin Ver.</td>\n",
       "      <td>3yphjkz7V5xFXdfBEXVKL6</td>\n",
       "      <td>11</td>\n",
       "      <td>4GJ6xDCF5jaUqD6avOuQT6</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       artist_name                     track_name                track_id  \\\n",
       "4   Eslabon Armado                Ella Baila Sola  3qQbCzHBycnDpGskqOWY0E   \n",
       "16       Sam Smith      Unholy (feat. Kim Petras)  0NZPBYD5qbEWRs3PrGiRkT   \n",
       "7             Rema  Calm Down (with Selena Gomez)  1s7oOCT8vauUh01PbJD6ps   \n",
       "22          Yandel                     Yandel 150  4FAKtPVycI4DxoOHC01YqD   \n",
       "39       Bad Bunny                 WHERE SHE GOES  2sTDlCxmuZCTDKKk9f1qus   \n",
       "44      Peso Pluma                            PRC  0cNSq9T5l8gZnpY14rsTR2   \n",
       "37    Taylor Swift                    Blank Space  1p80LdxRV74UKvL8gnD7ky   \n",
       "18  PinkPantheress             Boy's a liar Pt. 2  5CCr8msaN3MhgqBoa9yWhH   \n",
       "48   Natanael Cano                            AMG  0FxtC8uFapbpDBliAU3sd6   \n",
       "23     FIFTY FIFTY              Cupid - Twin Ver.  3yphjkz7V5xFXdfBEXVKL6   \n",
       "\n",
       "    track_popularity               artist_id  \n",
       "4                 79  0XeEobZplHxzM9QzFQWLiR  \n",
       "16                78  2wY79sveU1sp5g7SokKOiI  \n",
       "7                 77  46pWGuE3dSwY3bMMXGBvVS  \n",
       "22                77  0eHQ9o50hj6ZDNBt6Ys1sD  \n",
       "39                75  4q3ewBCX7sLwd24euuV69X  \n",
       "44                75  12GqGscKJx3aE4t07u7eVZ  \n",
       "37                74  06HL4z0CvFAxyc27GXpf02  \n",
       "18                74  78rUTD7y6Cy67W1RVzYs7t  \n",
       "48                73  0elWFr7TW8piilVRYJUe4P  \n",
       "23                11  4GJ6xDCF5jaUqD6avOuQT6  "
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "track_df = pd.DataFrame({'artist_name' : artist_name, 'track_name' : track_name, 'track_id' : track_id, 'track_popularity' : track_popularity, 'artist_id' : artist_id})\n",
    "print(track_df.shape)\n",
    "track_df_pop = track_df.sort_values(\"track_popularity\", ascending=False)\n",
    "track_df_pop.head(10)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2d9de054",
   "metadata": {},
   "source": [
    "### Adding Audio Features For the Top Songs of 2023"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "16a39df5",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(50, 21)\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_37934/313340102.py:26: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>index_x</th>\n",
       "      <th>artist_name</th>\n",
       "      <th>track_name</th>\n",
       "      <th>track_id</th>\n",
       "      <th>track_popularity</th>\n",
       "      <th>artist_id</th>\n",
       "      <th>artist_popularity</th>\n",
       "      <th>artist_genres</th>\n",
       "      <th>artist_followers</th>\n",
       "      <th>index_y</th>\n",
       "      <th>...</th>\n",
       "      <th>energy</th>\n",
       "      <th>loudness</th>\n",
       "      <th>speechiness</th>\n",
       "      <th>acousticness</th>\n",
       "      <th>instrumentalness</th>\n",
       "      <th>liveness</th>\n",
       "      <th>valence</th>\n",
       "      <th>tempo</th>\n",
       "      <th>duration_ms</th>\n",
       "      <th>time_signature</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>5</td>\n",
       "      <td>Taylor Swift</td>\n",
       "      <td>Cruel Summer</td>\n",
       "      <td>1BxfuPKGuaTgP7aM0Bbdwr</td>\n",
       "      <td>96</td>\n",
       "      <td>06HL4z0CvFAxyc27GXpf02</td>\n",
       "      <td>100</td>\n",
       "      <td>[pop]</td>\n",
       "      <td>106430450</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.702</td>\n",
       "      <td>-5.707</td>\n",
       "      <td>0.1570</td>\n",
       "      <td>0.11700</td>\n",
       "      <td>0.000021</td>\n",
       "      <td>0.1050</td>\n",
       "      <td>0.564</td>\n",
       "      <td>169.994</td>\n",
       "      <td>178427</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>10</td>\n",
       "      <td>Arctic Monkeys</td>\n",
       "      <td>I Wanna Be Yours</td>\n",
       "      <td>5XeFesFbtLpXzIVDNQP22n</td>\n",
       "      <td>92</td>\n",
       "      <td>7Ln80lUS6He07XvHI8qqHH</td>\n",
       "      <td>86</td>\n",
       "      <td>[garage rock, modern rock, permanent wave, roc...</td>\n",
       "      <td>24058026</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0.417</td>\n",
       "      <td>-9.345</td>\n",
       "      <td>0.0256</td>\n",
       "      <td>0.13600</td>\n",
       "      <td>0.022000</td>\n",
       "      <td>0.0974</td>\n",
       "      <td>0.479</td>\n",
       "      <td>67.528</td>\n",
       "      <td>183956</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0</td>\n",
       "      <td>Miley Cyrus</td>\n",
       "      <td>Flowers</td>\n",
       "      <td>7DSAEUvxU8FajXtRloy8M0</td>\n",
       "      <td>91</td>\n",
       "      <td>5YGY8feqx7naU7z4HrwZM6</td>\n",
       "      <td>86</td>\n",
       "      <td>[pop]</td>\n",
       "      <td>23536264</td>\n",
       "      <td>2</td>\n",
       "      <td>...</td>\n",
       "      <td>0.691</td>\n",
       "      <td>-4.775</td>\n",
       "      <td>0.0633</td>\n",
       "      <td>0.05840</td>\n",
       "      <td>0.000070</td>\n",
       "      <td>0.0232</td>\n",
       "      <td>0.632</td>\n",
       "      <td>118.048</td>\n",
       "      <td>200600</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2</td>\n",
       "      <td>Harry Styles</td>\n",
       "      <td>As It Was</td>\n",
       "      <td>4Dvkj6JhhA12EX05fT7y2e</td>\n",
       "      <td>91</td>\n",
       "      <td>6KImCVD70vtIoJWnq6nGn3</td>\n",
       "      <td>85</td>\n",
       "      <td>[pop]</td>\n",
       "      <td>31650918</td>\n",
       "      <td>3</td>\n",
       "      <td>...</td>\n",
       "      <td>0.731</td>\n",
       "      <td>-5.338</td>\n",
       "      <td>0.0557</td>\n",
       "      <td>0.34200</td>\n",
       "      <td>0.001010</td>\n",
       "      <td>0.3110</td>\n",
       "      <td>0.662</td>\n",
       "      <td>173.930</td>\n",
       "      <td>167303</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>43</td>\n",
       "      <td>Olivia Rodrigo</td>\n",
       "      <td>vampire</td>\n",
       "      <td>1kuGVB7EU95pJObxwvfwKS</td>\n",
       "      <td>91</td>\n",
       "      <td>1McMsnEElThX1knmY4oliG</td>\n",
       "      <td>90</td>\n",
       "      <td>[pop]</td>\n",
       "      <td>34620431</td>\n",
       "      <td>4</td>\n",
       "      <td>...</td>\n",
       "      <td>0.532</td>\n",
       "      <td>-5.745</td>\n",
       "      <td>0.0578</td>\n",
       "      <td>0.17700</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.2910</td>\n",
       "      <td>0.350</td>\n",
       "      <td>138.005</td>\n",
       "      <td>219724</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>40</td>\n",
       "      <td>Jimin</td>\n",
       "      <td>Like Crazy</td>\n",
       "      <td>3Ua0m0YmEjrMi9XErKcNiR</td>\n",
       "      <td>91</td>\n",
       "      <td>1oSPZhvZMIrWW5I41kPkkY</td>\n",
       "      <td>82</td>\n",
       "      <td>[k-pop]</td>\n",
       "      <td>7846127</td>\n",
       "      <td>5</td>\n",
       "      <td>...</td>\n",
       "      <td>0.733</td>\n",
       "      <td>-5.445</td>\n",
       "      <td>0.0419</td>\n",
       "      <td>0.00250</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.3570</td>\n",
       "      <td>0.362</td>\n",
       "      <td>120.001</td>\n",
       "      <td>212241</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>21</td>\n",
       "      <td>The Weeknd</td>\n",
       "      <td>Starboy</td>\n",
       "      <td>7MXVkk9YMctZqd1Srtv4MB</td>\n",
       "      <td>91</td>\n",
       "      <td>1Xyo4u8uXC1ZmMpatF05PJ</td>\n",
       "      <td>95</td>\n",
       "      <td>[canadian contemporary r&amp;b, canadian pop, pop]</td>\n",
       "      <td>81435797</td>\n",
       "      <td>6</td>\n",
       "      <td>...</td>\n",
       "      <td>0.587</td>\n",
       "      <td>-7.015</td>\n",
       "      <td>0.2760</td>\n",
       "      <td>0.14100</td>\n",
       "      <td>0.000006</td>\n",
       "      <td>0.1370</td>\n",
       "      <td>0.486</td>\n",
       "      <td>186.003</td>\n",
       "      <td>230453</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>38</td>\n",
       "      <td>The Weeknd</td>\n",
       "      <td>Blinding Lights</td>\n",
       "      <td>0VjIjW4GlUZAMYd2vXMi3b</td>\n",
       "      <td>90</td>\n",
       "      <td>1Xyo4u8uXC1ZmMpatF05PJ</td>\n",
       "      <td>95</td>\n",
       "      <td>[canadian contemporary r&amp;b, canadian pop, pop]</td>\n",
       "      <td>81435797</td>\n",
       "      <td>7</td>\n",
       "      <td>...</td>\n",
       "      <td>0.730</td>\n",
       "      <td>-5.934</td>\n",
       "      <td>0.0598</td>\n",
       "      <td>0.00146</td>\n",
       "      <td>0.000095</td>\n",
       "      <td>0.0897</td>\n",
       "      <td>0.334</td>\n",
       "      <td>171.005</td>\n",
       "      <td>200040</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>36</td>\n",
       "      <td>SZA</td>\n",
       "      <td>Snooze</td>\n",
       "      <td>4iZ4pt7kvcaH6Yo8UoZ4s2</td>\n",
       "      <td>90</td>\n",
       "      <td>7tYKF4w9nC0nq9CsPZTHyP</td>\n",
       "      <td>91</td>\n",
       "      <td>[pop, r&amp;b, rap]</td>\n",
       "      <td>18812393</td>\n",
       "      <td>8</td>\n",
       "      <td>...</td>\n",
       "      <td>0.551</td>\n",
       "      <td>-7.231</td>\n",
       "      <td>0.1320</td>\n",
       "      <td>0.14100</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.1100</td>\n",
       "      <td>0.392</td>\n",
       "      <td>143.008</td>\n",
       "      <td>201800</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>19</td>\n",
       "      <td>David Kushner</td>\n",
       "      <td>Daylight</td>\n",
       "      <td>1odExI7RdWc4BT515LTAwj</td>\n",
       "      <td>90</td>\n",
       "      <td>33NVpKoXjItPwUJTMZIOiY</td>\n",
       "      <td>77</td>\n",
       "      <td>[gen z singer-songwriter, singer-songwriter pop]</td>\n",
       "      <td>2074960</td>\n",
       "      <td>9</td>\n",
       "      <td>...</td>\n",
       "      <td>0.430</td>\n",
       "      <td>-9.475</td>\n",
       "      <td>0.0335</td>\n",
       "      <td>0.83000</td>\n",
       "      <td>0.000441</td>\n",
       "      <td>0.0930</td>\n",
       "      <td>0.324</td>\n",
       "      <td>130.090</td>\n",
       "      <td>212954</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10 rows × 21 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   index_x     artist_name        track_name                track_id  \\\n",
       "0        5    Taylor Swift      Cruel Summer  1BxfuPKGuaTgP7aM0Bbdwr   \n",
       "1       10  Arctic Monkeys  I Wanna Be Yours  5XeFesFbtLpXzIVDNQP22n   \n",
       "2        0     Miley Cyrus           Flowers  7DSAEUvxU8FajXtRloy8M0   \n",
       "3        2    Harry Styles         As It Was  4Dvkj6JhhA12EX05fT7y2e   \n",
       "4       43  Olivia Rodrigo           vampire  1kuGVB7EU95pJObxwvfwKS   \n",
       "5       40           Jimin        Like Crazy  3Ua0m0YmEjrMi9XErKcNiR   \n",
       "6       21      The Weeknd           Starboy  7MXVkk9YMctZqd1Srtv4MB   \n",
       "7       38      The Weeknd   Blinding Lights  0VjIjW4GlUZAMYd2vXMi3b   \n",
       "8       36             SZA            Snooze  4iZ4pt7kvcaH6Yo8UoZ4s2   \n",
       "9       19   David Kushner          Daylight  1odExI7RdWc4BT515LTAwj   \n",
       "\n",
       "   track_popularity               artist_id  artist_popularity  \\\n",
       "0                96  06HL4z0CvFAxyc27GXpf02                100   \n",
       "1                92  7Ln80lUS6He07XvHI8qqHH                 86   \n",
       "2                91  5YGY8feqx7naU7z4HrwZM6                 86   \n",
       "3                91  6KImCVD70vtIoJWnq6nGn3                 85   \n",
       "4                91  1McMsnEElThX1knmY4oliG                 90   \n",
       "5                91  1oSPZhvZMIrWW5I41kPkkY                 82   \n",
       "6                91  1Xyo4u8uXC1ZmMpatF05PJ                 95   \n",
       "7                90  1Xyo4u8uXC1ZmMpatF05PJ                 95   \n",
       "8                90  7tYKF4w9nC0nq9CsPZTHyP                 91   \n",
       "9                90  33NVpKoXjItPwUJTMZIOiY                 77   \n",
       "\n",
       "                                       artist_genres  artist_followers  \\\n",
       "0                                              [pop]         106430450   \n",
       "1  [garage rock, modern rock, permanent wave, roc...          24058026   \n",
       "2                                              [pop]          23536264   \n",
       "3                                              [pop]          31650918   \n",
       "4                                              [pop]          34620431   \n",
       "5                                            [k-pop]           7846127   \n",
       "6     [canadian contemporary r&b, canadian pop, pop]          81435797   \n",
       "7     [canadian contemporary r&b, canadian pop, pop]          81435797   \n",
       "8                                    [pop, r&b, rap]          18812393   \n",
       "9   [gen z singer-songwriter, singer-songwriter pop]           2074960   \n",
       "\n",
       "   index_y  ...  energy  loudness  speechiness  acousticness  \\\n",
       "0        0  ...   0.702    -5.707       0.1570       0.11700   \n",
       "1        1  ...   0.417    -9.345       0.0256       0.13600   \n",
       "2        2  ...   0.691    -4.775       0.0633       0.05840   \n",
       "3        3  ...   0.731    -5.338       0.0557       0.34200   \n",
       "4        4  ...   0.532    -5.745       0.0578       0.17700   \n",
       "5        5  ...   0.733    -5.445       0.0419       0.00250   \n",
       "6        6  ...   0.587    -7.015       0.2760       0.14100   \n",
       "7        7  ...   0.730    -5.934       0.0598       0.00146   \n",
       "8        8  ...   0.551    -7.231       0.1320       0.14100   \n",
       "9        9  ...   0.430    -9.475       0.0335       0.83000   \n",
       "\n",
       "   instrumentalness  liveness  valence    tempo  duration_ms  time_signature  \n",
       "0          0.000021    0.1050    0.564  169.994       178427             4.0  \n",
       "1          0.022000    0.0974    0.479   67.528       183956             4.0  \n",
       "2          0.000070    0.0232    0.632  118.048       200600             4.0  \n",
       "3          0.001010    0.3110    0.662  173.930       167303             4.0  \n",
       "4          0.000000    0.2910    0.350  138.005       219724             4.0  \n",
       "5          0.000000    0.3570    0.362  120.001       212241             4.0  \n",
       "6          0.000006    0.1370    0.486  186.003       230453             4.0  \n",
       "7          0.000095    0.0897    0.334  171.005       200040             4.0  \n",
       "8          0.000000    0.1100    0.392  143.008       201800             4.0  \n",
       "9          0.000441    0.0930    0.324  130.090       212954             4.0  \n",
       "\n",
       "[10 rows x 21 columns]"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Artist Data\n",
    "artist_popularity = []\n",
    "artist_genres = []\n",
    "artist_followers = []\n",
    "for a_id in track_df_pop.artist_id:\n",
    "    artist = sp.artist(a_id)\n",
    "    artist_popularity.append(artist['popularity'])\n",
    "    artist_genres.append(artist['genres'])\n",
    "    artist_followers.append(artist['followers']['total'])\n",
    "\n",
    "# Left Joining Artist Data to Songs\n",
    "track_df_pop = track_df_pop.assign(artist_popularity=artist_popularity, artist_genres=artist_genres,\n",
    "                                             artist_followers=artist_followers)\n",
    "\n",
    "# Track Data\n",
    "track_features = []\n",
    "for t_id in track_df_pop['track_id']:\n",
    "    af = sp.audio_features(t_id)\n",
    "    track_features.append(af)\n",
    "\n",
    "tf_df = pd.DataFrame(columns=['danceability', 'energy', 'key', 'loudness', 'mode', 'speechiness', 'acousticness',\n",
    "                              'instrumentalness', 'liveness', 'valence', 'tempo', 'type', 'id', 'uri', 'track_href',\n",
    "                              'analysis_url', 'duration_ms'])\n",
    "for item in track_features:\n",
    "    for feat in item:\n",
    "        tf_df = tf_df.append(feat, ignore_index=True)\n",
    "\n",
    "# Drop Unnecessary Attributes from 'audio_features' endpoint\n",
    "tf_df['duration_ms'] = pd.to_numeric(tf_df['duration_ms'])\n",
    "cols_to_drop2 = ['key', 'mode', 'type', 'uri', 'track_href', 'analysis_url']\n",
    "tf_df = tf_df.drop(columns=cols_to_drop2)\n",
    "\n",
    "# Datatype Manipulation\n",
    "track_df_pop['artist_name'] = track_df_pop['artist_name'].astype(\"string\")\n",
    "track_df_pop['track_name'] = track_df_pop['track_name'].astype(\"string\")\n",
    "track_df_pop['track_id'] = track_df_pop['track_id'].astype(\"string\")\n",
    "track_df_pop['artist_id'] = track_df_pop['artist_id'].astype(\"string\")\n",
    "tf_df['instrumentalness'] = pd.to_numeric(tf_df['instrumentalness'])\n",
    "tf_df = tf_df.rename(columns={'id': 'track_id'})\n",
    "\n",
    "# Features & Track Dataframe Merge\n",
    "top_tracks_2023 = pd.merge(\n",
    "    track_df_pop.reset_index(),\n",
    "    tf_df.reset_index(),\n",
    "    on=[\"track_id\"]\n",
    ")\n",
    "\n",
    "# Print the resulting DataFrame's shape to confirm it has 100 tracks\n",
    "print(top_tracks_2023.shape)\n",
    "top_tracks_2023.head(10)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e8be3dcc",
   "metadata": {},
   "source": [
    "### Saving the Results to a CSV"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "13a90622",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Saved Dataframe succesfully to csv file!\n"
     ]
    }
   ],
   "source": [
    "top_tracks_2023.to_csv('topTracksOf2023.csv')\n",
    "print('Saved Dataframe succesfully to csv file!')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9763cec6",
   "metadata": {},
   "source": [
    "### Creating a Function to streamline the process\n",
    "This function will assume the prior initialization of appropriate Spotify credentials to pull from an API."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "aee73f4c",
   "metadata": {},
   "outputs": [],
   "source": [
    "def get_top_tracks_from_playlist(playlist_id, sp):\n",
    "    # Initialize lists to store track data\n",
    "    artist_name = []\n",
    "    track_name = []\n",
    "    track_popularity = []\n",
    "    artist_id = []\n",
    "    track_id = []\n",
    "\n",
    "    # Retrieve tracks from the playlist\n",
    "    track_results = sp.playlist(playlist_id=playlist_id, limit=50)\n",
    "\n",
    "    # Iterate over each track in the playlist\n",
    "    for track_item in track_results['tracks']['items']:\n",
    "        # Retrieve track details\n",
    "        track = track_item['track']\n",
    "        \n",
    "        # Extract track particulars\n",
    "        artist_name.append(track['artists'][0]['name'])\n",
    "        artist_id.append(track['artists'][0]['id'])\n",
    "        track_name.append(track['name'])\n",
    "        track_id.append(track['id'])\n",
    "        track_popularity.append(track['popularity'])\n",
    "\n",
    "    # Create DataFrame from track data\n",
    "    track_df = pd.DataFrame({'artist_name' : artist_name, \n",
    "                             'track_name' : track_name, \n",
    "                             'track_id' : track_id, \n",
    "                             'track_popularity' : track_popularity, \n",
    "                             'artist_id' : artist_id})\n",
    "    \n",
    "    # Sort tracks by popularity\n",
    "    track_df_pop = track_df.sort_values(\"track_popularity\", ascending=False)\n",
    "    \n",
    "    # Sleep to rest before pulling songs data\n",
    "    time.sleep(30)\n",
    "\n",
    "    # Retrieve artist data\n",
    "    artist_popularity = []\n",
    "    artist_genres = []\n",
    "    artist_followers = []\n",
    "    for a_id in track_df_pop.artist_id:\n",
    "        artist = sp.artist(a_id)\n",
    "        artist_popularity.append(artist['popularity'])\n",
    "        artist_genres.append(artist['genres'])\n",
    "        artist_followers.append(artist['followers']['total'])\n",
    "\n",
    "    # Left Join Artist Data to Songs\n",
    "    track_df_pop = track_df_pop.assign(artist_popularity=artist_popularity, \n",
    "                                       artist_genres=artist_genres,\n",
    "                                       artist_followers=artist_followers)\n",
    "\n",
    "    # Retrieve track features\n",
    "    track_features = []\n",
    "    for t_id in track_df_pop['track_id']:\n",
    "        af = sp.audio_features(t_id)\n",
    "        track_features.append(af)\n",
    "\n",
    "    # Create DataFrame from track features\n",
    "    tf_df = pd.DataFrame(columns=['danceability', 'energy', 'key', 'loudness', 'mode', 'speechiness', 'acousticness',\n",
    "                                  'instrumentalness', 'liveness', 'valence', 'tempo', 'type', 'id', 'uri', 'track_href',\n",
    "                                  'analysis_url', 'duration_ms'])\n",
    "    for item in track_features:\n",
    "        for feat in item:\n",
    "            tf_df = tf_df.append(feat, ignore_index=True)\n",
    "\n",
    "    # Drop Unnecessary Attributes from 'audio_features' endpoint\n",
    "    tf_df['duration_ms'] = pd.to_numeric(tf_df['duration_ms'])\n",
    "    cols_to_drop2 = ['key', 'mode', 'type', 'uri', 'track_href', 'analysis_url']\n",
    "    tf_df = tf_df.drop(columns=cols_to_drop2)\n",
    "\n",
    "    # Data type manipulation\n",
    "    track_df_pop['artist_name'] = track_df_pop['artist_name'].astype(\"string\")\n",
    "    track_df_pop['track_name'] = track_df_pop['track_name'].astype(\"string\")\n",
    "    track_df_pop['track_id'] = track_df_pop['track_id'].astype(\"string\")\n",
    "    track_df_pop['artist_id'] = track_df_pop['artist_id'].astype(\"string\")\n",
    "    tf_df['instrumentalness'] = pd.to_numeric(tf_df['instrumentalness'])\n",
    "    tf_df = tf_df.rename(columns={'id': 'track_id'})\n",
    "\n",
    "    # Merge Features & Track Dataframes\n",
    "    top_tracks = pd.merge(track_df_pop.reset_index(), tf_df.reset_index(), on=[\"track_id\"])\n",
    "    \n",
    "    return top_tracks"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fc6a6f0c",
   "metadata": {},
   "source": [
    "### Saving the Top Tracks of 2022 via Spotify's Official Playlist"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "b47ab7e6",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(50, 21)\n",
      "   index_x        artist_name                              track_name  \\\n",
      "0       41         Noah Kahan                            Stick Season   \n",
      "1        0       Harry Styles                               As It Was   \n",
      "2       28                SZA                                  Snooze   \n",
      "3        5       David Guetta                         I'm Good (Blue)   \n",
      "4        7        OneRepublic                         I Ain't Worried   \n",
      "5        8       Taylor Swift                               Anti-Hero   \n",
      "6       37         Zach Bryan                 Something in the Orange   \n",
      "7       12       Metro Boomin  Creepin' (with The Weeknd & 21 Savage)   \n",
      "8       48  Sabrina Carpenter                                Nonsense   \n",
      "9       19               d4vd                       Romantic Homicide   \n",
      "\n",
      "                 track_id  track_popularity               artist_id  \\\n",
      "0  0mflMxspEfB0VbI1kyLiAv                94  2RQXRUsr4IW1f3mKyKsy4B   \n",
      "1  4Dvkj6JhhA12EX05fT7y2e                91  6KImCVD70vtIoJWnq6nGn3   \n",
      "2  4iZ4pt7kvcaH6Yo8UoZ4s2                90  7tYKF4w9nC0nq9CsPZTHyP   \n",
      "3  4uUG5RXrOk84mYEfFvj3cK                89  1Cs0zKBU1kc0i8ypK3B9ai   \n",
      "4  4h9wh7iOZ0GGn8QVp4RAOB                89  5Pwc4xIPtQLFEnJriah9YJ   \n",
      "5  0V3wPSX9ygBnCm8psDIegu                89  06HL4z0CvFAxyc27GXpf02   \n",
      "6  3WMj8moIAXJhHsyLaqIIHI                88  40ZNYROS4zLfyyBSs2PGe2   \n",
      "7  2dHHgzDwk4BJdRwy9uXhTO                87  0iEtIxbK0KxaSlF7G42ZOp   \n",
      "8  6dgUya35uo964z7GZXM07g                87  74KM79TiuVKeVCqs8QtB0B   \n",
      "9  1xK59OXxi2TAAAbmZK0kBL                87  5y8tKLUfMvliMe8IKamR32   \n",
      "\n",
      "   artist_popularity                               artist_genres  \\\n",
      "0                 87                                [pov: indie]   \n",
      "1                 85                                       [pop]   \n",
      "2                 91                             [pop, r&b, rap]   \n",
      "3                 88  [big room, dance pop, edm, pop, pop dance]   \n",
      "4                 83                           [piano rock, pop]   \n",
      "5                100                                       [pop]   \n",
      "6                 88                  [classic oklahoma country]   \n",
      "7                 93                              [hip hop, rap]   \n",
      "8                 81                                       [pop]   \n",
      "9                 78                               [bedroom pop]   \n",
      "\n",
      "   artist_followers  index_y  ...  energy  loudness  speechiness  \\\n",
      "0           2571985        0  ...   0.488    -6.894       0.0682   \n",
      "1          31662371        1  ...   0.731    -5.338       0.0557   \n",
      "2          18838208        2  ...   0.551    -7.231       0.1320   \n",
      "3          25338070        3  ...   0.965    -3.673       0.0343   \n",
      "4          16727090        4  ...   0.797    -5.927       0.0475   \n",
      "5         106532993        5  ...   0.643    -6.571       0.0519   \n",
      "6           3627184        6  ...   0.192   -12.151       0.0400   \n",
      "7           7581488        7  ...   0.620    -6.005       0.0484   \n",
      "8           7693648        8  ...   0.697    -4.912       0.0340   \n",
      "9           2419820        9  ...   0.544   -10.613       0.0299   \n",
      "\n",
      "   acousticness  instrumentalness  liveness  valence    tempo  duration_ms  \\\n",
      "0       0.78200          0.000000    0.1020    0.817  117.913       182347   \n",
      "1       0.34200          0.001010    0.3110    0.662  173.930       167303   \n",
      "2       0.14100          0.000000    0.1100    0.392  143.008       201800   \n",
      "3       0.00383          0.000007    0.3710    0.304  128.040       175238   \n",
      "4       0.08260          0.000745    0.0546    0.825  139.994       148486   \n",
      "5       0.13000          0.000002    0.1420    0.533   97.008       200690   \n",
      "6       0.55500          0.000008    0.0954    0.148  175.212       228013   \n",
      "7       0.41700          0.000000    0.0822    0.172   97.950       221520   \n",
      "8       0.02680          0.000000    0.2240    0.732  138.992       163648   \n",
      "9       0.45300          0.008050    0.3220    0.216  132.052       132631   \n",
      "\n",
      "   time_signature  \n",
      "0             4.0  \n",
      "1             4.0  \n",
      "2             4.0  \n",
      "3             4.0  \n",
      "4             4.0  \n",
      "5             4.0  \n",
      "6             3.0  \n",
      "7             4.0  \n",
      "8             4.0  \n",
      "9             4.0  \n",
      "\n",
      "[10 rows x 21 columns]\n",
      "Saved DataFrame successfully to csv file!\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n"
     ]
    }
   ],
   "source": [
    "playlist_2022 = '6TxWM4VW8EAnZ22bLq7Tit'\n",
    "top_tracks_2022 = get_top_tracks_from_playlist(playlist_2022, sp)\n",
    "print(top_tracks_2022.shape)\n",
    "print(top_tracks_2022.head(10))\n",
    "top_tracks_2022.to_csv('topTracksOf2022.csv')\n",
    "print('Saved DataFrame successfully to csv file!')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "83e97a16",
   "metadata": {},
   "source": [
    "### Saving the Top Tracks of 2021 via Spotify's Official Playlist"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "a1de3235",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(50, 21)\n",
      "   index_x     artist_name       track_name                track_id  \\\n",
      "0       12   Justin Bieber            Ghost  6I3mqTwhRpn34SLVafSH7G   \n",
      "1        1  Olivia Rodrigo  drivers license  5wANPM4fQCJwkGd4rN57mH   \n",
      "2       11  Olivia Rodrigo          deja vu  6HU7h9RYOaPRFeh0R3UeAr   \n",
      "3       13  Olivia Rodrigo          traitor  5CZ40GBx1sQ9agT82CLQCT   \n",
      "4        2  Olivia Rodrigo         good 4 u  4ZtFanR9U6ndgddUvNcjcG   \n",
      "5        4        Maroon 5         Memories  4cktbXiXOapiLBMprHFErI   \n",
      "6       30  Olivia Rodrigo   favorite crime  5JCoSi02qi3jJeHdZXMmR8   \n",
      "7       28      Surf Curse           Freaks  7EkWXAI1wn8Ii883ecd9xr   \n",
      "8       26  Olivia Rodrigo          happier  2tGvwE8GcFKwNdAXMnlbfl   \n",
      "9       10        Doja Cat            Woman  6Uj1ctrBOjOas8xZXGqKk4   \n",
      "\n",
      "   track_popularity               artist_id  artist_popularity  \\\n",
      "0                87  1uNFoZAHBGtllmzznpCI3s                 89   \n",
      "1                86  1McMsnEElThX1knmY4oliG                 90   \n",
      "2                86  1McMsnEElThX1knmY4oliG                 90   \n",
      "3                86  1McMsnEElThX1knmY4oliG                 90   \n",
      "4                85  1McMsnEElThX1knmY4oliG                 90   \n",
      "5                84  04gDigrS5kc9YWfZHwBETP                 85   \n",
      "6                84  1McMsnEElThX1knmY4oliG                 90   \n",
      "7                84  1gl0S9pS0Zw0qfa14rDD3D                 68   \n",
      "8                84  1McMsnEElThX1knmY4oliG                 90   \n",
      "9                84  5cj0lLjcoR7YOSnhnX0Po5                 87   \n",
      "\n",
      "                                       artist_genres  artist_followers  \\\n",
      "0                                [canadian pop, pop]          74339733   \n",
      "1                                              [pop]          34655331   \n",
      "2                                              [pop]          34655331   \n",
      "3                                              [pop]          34655331   \n",
      "4                                              [pop]          34655331   \n",
      "5                                              [pop]          41162043   \n",
      "6                                              [pop]          34655331   \n",
      "7  [dreamo, indie surf, pov: indie, surf punk, ve...           1107495   \n",
      "8                                              [pop]          34655331   \n",
      "9                                   [dance pop, pop]          29319971   \n",
      "\n",
      "   index_y  ...  energy  loudness  speechiness  acousticness  \\\n",
      "0        0  ...   0.741    -5.569       0.0478      0.185000   \n",
      "1        1  ...   0.431    -8.810       0.0578      0.768000   \n",
      "2        2  ...   0.612    -7.222       0.1120      0.584000   \n",
      "3        3  ...   0.339    -7.885       0.0338      0.691000   \n",
      "4        4  ...   0.664    -5.044       0.1540      0.335000   \n",
      "5        5  ...   0.327    -7.241       0.0557      0.841000   \n",
      "6        6  ...   0.272   -10.497       0.0364      0.866000   \n",
      "7        7  ...   0.941    -9.918       0.0466      0.000038   \n",
      "8        8  ...   0.443    -9.720       0.1330      0.765000   \n",
      "9        9  ...   0.764    -4.175       0.0854      0.088800   \n",
      "\n",
      "   instrumentalness  liveness  valence    tempo  duration_ms  time_signature  \n",
      "0          0.000029    0.4150   0.4410  153.960       153190             4.0  \n",
      "1          0.000014    0.1060   0.1370  143.875       242013             4.0  \n",
      "2          0.000006    0.3700   0.1780  180.917       215507             4.0  \n",
      "3          0.000000    0.1200   0.0849  100.607       229227             4.0  \n",
      "4          0.000000    0.0849   0.6880  166.928       178147             4.0  \n",
      "5          0.000000    0.0821   0.5950   91.050       189486             4.0  \n",
      "6          0.000000    0.1470   0.2180  172.929       152667             4.0  \n",
      "7          0.633000    0.0511   0.4070  179.626       147062             4.0  \n",
      "8          0.000010    0.0839   0.3380  168.924       175933             3.0  \n",
      "9          0.002940    0.1170   0.8810  107.998       172627             4.0  \n",
      "\n",
      "[10 rows x 21 columns]\n",
      "Saved DataFrame successfully to csv file!\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n"
     ]
    }
   ],
   "source": [
    "playlist_2021 = '49xOpHGtsm4NugHilEociL'\n",
    "top_tracks_2021 = get_top_tracks_from_playlist(playlist_2021, sp)\n",
    "print(top_tracks_2021.shape)\n",
    "print(top_tracks_2021.head(10))\n",
    "top_tracks_2021.to_csv('topTracksOf2021.csv')\n",
    "print('Saved DataFrame successfully to csv file!')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "65d42b50",
   "metadata": {},
   "source": [
    "### Saving the Top Tracks of 2020 via Spotify's Official Playlist"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "3fd64930",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(50, 21)\n",
      "   index_x    artist_name                                     track_name  \\\n",
      "0        0     The Weeknd                                Blinding Lights   \n",
      "1        9  Lewis Capaldi                              Someone You Loved   \n",
      "2       44  Billie Eilish                           lovely (with Khalid)   \n",
      "3       40   Travis Scott                                     goosebumps   \n",
      "4        6   Harry Styles                               Watermelon Sugar   \n",
      "5       12    Post Malone                                        Circles   \n",
      "6       37    Post Malone  Sunflower - Spider-Man: Into the Spider-Verse   \n",
      "7       36   Travis Scott                            HIGHEST IN THE ROOM   \n",
      "8       29         Eminem                    Godzilla (feat. Juice WRLD)   \n",
      "9       21   Harry Styles                                      Adore You   \n",
      "\n",
      "                 track_id  track_popularity               artist_id  \\\n",
      "0  0VjIjW4GlUZAMYd2vXMi3b                90  1Xyo4u8uXC1ZmMpatF05PJ   \n",
      "1  7qEHsqek33rTcFNT9PFqLf                89  4GNC7GD6oZMSxPGyXy4MNB   \n",
      "2  0u2P5u6lvoDfwTYjAADbn4                88  6qqNVTkY8uBg9cP3Jd7DAH   \n",
      "3  6gBFPUFcJLzWGx4lenP6h2                87  0Y5tJX1MQlPlqiwlOH1tJY   \n",
      "4  6UelLqGlWMcVH1E5c4H7lY                87  6KImCVD70vtIoJWnq6nGn3   \n",
      "5  21jGcNKet2qwijlDFuPiPb                86  246dkjvS1zLTtiykXe5h60   \n",
      "6  0RiRZpuVRbi7oqRdSMwhQY                85  246dkjvS1zLTtiykXe5h60   \n",
      "7  3eekarcy7kvN4yt5ZFzltW                84  0Y5tJX1MQlPlqiwlOH1tJY   \n",
      "8  7FIWs0pqAYbP91WWM0vlTQ                84  7dGJo4pcD2V6oG8kP0tJRR   \n",
      "9  3jjujdWJ72nww5eGnfs2E7                84  6KImCVD70vtIoJWnq6nGn3   \n",
      "\n",
      "   artist_popularity                                   artist_genres  \\\n",
      "0                 95  [canadian contemporary r&b, canadian pop, pop]   \n",
      "1                 81                                   [pop, uk pop]   \n",
      "2                 88                                  [art pop, pop]   \n",
      "3                 94                      [hip hop, rap, slap house]   \n",
      "4                 85                                           [pop]   \n",
      "5                 88                [dfw rap, melodic rap, pop, rap]   \n",
      "6                 88                [dfw rap, melodic rap, pop, rap]   \n",
      "7                 94                      [hip hop, rap, slap house]   \n",
      "8                 90                 [detroit hip hop, hip hop, rap]   \n",
      "9                 85                                           [pop]   \n",
      "\n",
      "   artist_followers  index_y  ...  energy  loudness  speechiness  \\\n",
      "0          81484963        0  ...   0.730    -5.934       0.0598   \n",
      "1          12376107        1  ...   0.405    -5.679       0.0319   \n",
      "2          93103374        2  ...   0.296   -10.109       0.0333   \n",
      "3          28392689        3  ...   0.728    -3.370       0.0484   \n",
      "4          31662371        4  ...   0.816    -4.209       0.0465   \n",
      "5          43405706        5  ...   0.762    -3.497       0.0395   \n",
      "6          43405706        6  ...   0.522    -4.368       0.0575   \n",
      "7          28392689        7  ...   0.427    -8.764       0.0317   \n",
      "8          82668509        8  ...   0.745    -5.260       0.3420   \n",
      "9          31662371        9  ...   0.771    -3.675       0.0483   \n",
      "\n",
      "   acousticness  instrumentalness  liveness  valence    tempo  duration_ms  \\\n",
      "0       0.00146          0.000095    0.0897   0.3340  171.005       200040   \n",
      "1       0.75100          0.000000    0.1050   0.4460  109.891       182161   \n",
      "2       0.93400          0.000000    0.0950   0.1200  115.284       200186   \n",
      "3       0.08470          0.000000    0.1490   0.4300  130.049       243837   \n",
      "4       0.12200          0.000000    0.3350   0.5570   95.390       174000   \n",
      "5       0.19200          0.002440    0.0863   0.5530  120.042       215280   \n",
      "6       0.53300          0.000000    0.0685   0.9250   89.960       157560   \n",
      "7       0.05460          0.000006    0.2100   0.0605   76.469       175721   \n",
      "8       0.14500          0.000000    0.2920   0.8290  165.995       210800   \n",
      "9       0.02370          0.000007    0.1020   0.5690   99.048       207133   \n",
      "\n",
      "   time_signature  \n",
      "0             4.0  \n",
      "1             4.0  \n",
      "2             4.0  \n",
      "3             4.0  \n",
      "4             4.0  \n",
      "5             4.0  \n",
      "6             4.0  \n",
      "7             4.0  \n",
      "8             4.0  \n",
      "9             4.0  \n",
      "\n",
      "[10 rows x 21 columns]\n",
      "Saved DataFrame successfully to csv file!\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_41188/1809298426.py:64: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n"
     ]
    }
   ],
   "source": [
    "playlist_2020 = '37i9dQZF1DX7Jl5KP2eZaS'\n",
    "top_tracks_2020 = get_top_tracks_from_playlist(playlist_2020, sp)\n",
    "print(top_tracks_2020.shape)\n",
    "print(top_tracks_2020.head(10))\n",
    "top_tracks_2020.to_csv('topTracksOf2020.csv')\n",
    "print('Saved DataFrame successfully to csv file!')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "62d1cef6",
   "metadata": {},
   "source": [
    "### Saving Spotify's 'New Music Friday Playlist'"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "754f3d26",
   "metadata": {},
   "source": [
    "Extracted on April 12th, 2024, this playlist and the songs from it were extracted for the purpose of being used as a base for predicting the continuos variable, popularity. This playlist linked [here](https://open.spotify.com/playlist/37i9dQZF1DX4JAvHpjipBk?si=a76d4fbbf0524563), is one Spotify's most popular available playlists with over 4 million followers, and is the one updated most regularly with new music with suggestions for the entire user base. Since it is curated internally by Spotify, we are attempting with this analysis to predict which of April's new music will come out on top at the end of the year."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "ae8dc26d",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Defined for the purpose of extracting the 'New Music Friday' playlist data\n",
    "    # The API limits extraction of up to 50 songs per playlist, so this takes the top 50\n",
    "\n",
    "def get_top_tracks_from_playlist(playlist_id, sp, limit=50):\n",
    "    # Initialize lists to store track data\n",
    "    artist_name = []\n",
    "    track_name = []\n",
    "    track_popularity = []\n",
    "    artist_id = []\n",
    "    track_id = []\n",
    "\n",
    "    # Retrieve tracks from the playlist in batches\n",
    "    offset = 0\n",
    "    while len(track_id) < limit:\n",
    "        track_results = sp.playlist_tracks(playlist_id=playlist_id, offset=offset)\n",
    "        for track_item in track_results['items']:\n",
    "            # Retrieve track details\n",
    "            track = track_item['track']\n",
    "            # Extract track particulars\n",
    "            artist_name.append(track['artists'][0]['name'])\n",
    "            artist_id.append(track['artists'][0]['id'])\n",
    "            track_name.append(track['name'])\n",
    "            track_id.append(track['id'])\n",
    "            track_popularity.append(track['popularity'])\n",
    "        offset += len(track_results['items'])\n",
    "        if not track_results['next'] or offset >= limit:\n",
    "            break\n",
    "\n",
    "    # Create DataFrame from track data\n",
    "    track_df = pd.DataFrame({'artist_name': artist_name,\n",
    "                             'track_name': track_name,\n",
    "                             'track_id': track_id,\n",
    "                             'track_popularity': track_popularity,\n",
    "                             'artist_id': artist_id})\n",
    "\n",
    "    # Sort tracks by popularity\n",
    "    track_df_pop = track_df.sort_values(\"track_popularity\", ascending=False)\n",
    "\n",
    "    # Sleep to rest before pulling songs data\n",
    "    time.sleep(30)\n",
    "\n",
    "    # Retrieve artist data\n",
    "    artist_popularity = []\n",
    "    artist_genres = []\n",
    "    artist_followers = []\n",
    "    for a_id in track_df_pop.artist_id:\n",
    "        artist = sp.artist(a_id)\n",
    "        artist_popularity.append(artist['popularity'])\n",
    "        artist_genres.append(artist['genres'])\n",
    "        artist_followers.append(artist['followers']['total'])\n",
    "\n",
    "    # Left Join Artist Data to Songs\n",
    "    track_df_pop = track_df_pop.assign(artist_popularity=artist_popularity,\n",
    "                                       artist_genres=artist_genres,\n",
    "                                       artist_followers=artist_followers)\n",
    "\n",
    "    # Retrieve track features\n",
    "    track_features = []\n",
    "    for t_id in track_df_pop['track_id']:\n",
    "        af = sp.audio_features(t_id)\n",
    "        track_features.append(af)\n",
    "\n",
    "    # Create DataFrame from track features\n",
    "    tf_df = pd.DataFrame(columns=['danceability', 'energy', 'key', 'loudness', 'mode', 'speechiness', 'acousticness',\n",
    "                                  'instrumentalness', 'liveness', 'valence', 'tempo', 'type', 'id', 'uri', 'track_href',\n",
    "                                  'analysis_url', 'duration_ms'])\n",
    "    for item in track_features:\n",
    "        for feat in item:\n",
    "            tf_df = tf_df.append(feat, ignore_index=True)\n",
    "\n",
    "    # Drop Unnecessary Attributes from 'audio_features' endpoint\n",
    "    tf_df['duration_ms'] = pd.to_numeric(tf_df['duration_ms'])\n",
    "    cols_to_drop2 = ['key', 'mode', 'type', 'uri', 'track_href', 'analysis_url']\n",
    "    tf_df = tf_df.drop(columns=cols_to_drop2)\n",
    "\n",
    "    # Data type manipulation\n",
    "    track_df_pop['artist_name'] = track_df_pop['artist_name'].astype(\"string\")\n",
    "    track_df_pop['track_name'] = track_df_pop['track_name'].astype(\"string\")\n",
    "    track_df_pop['track_id'] = track_df_pop['track_id'].astype(\"string\")\n",
    "    track_df_pop['artist_id'] = track_df_pop['artist_id'].astype(\"string\")\n",
    "    tf_df['instrumentalness'] = pd.to_numeric(tf_df['instrumentalness'])\n",
    "    tf_df = tf_df.rename(columns={'id': 'track_id'})\n",
    "\n",
    "    # Merge Features & Track Dataframes\n",
    "    top_tracks = pd.merge(track_df_pop.reset_index(), tf_df.reset_index(), on=[\"track_id\"])\n",
    "\n",
    "    return top_tracks\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "ab91b8ab",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(100, 21)\n",
      "   index_x      artist_name              track_name                track_id  \\\n",
      "0        4    PARTYNEXTDOOR     L o s e M y M i n d  7nnSTOoBWl2ctLxoqgCZoq   \n",
      "1       15             TINI            buenos aires  7L0BH62HRIap3Fg6KUyQfR   \n",
      "2        3     Fred again..  BerwynGesaffNeighbours  21f4TjwWXbnqg8d5R6oq8Y   \n",
      "3       26             Feid                   Fecha  14LaTeixKug7O2jNMK8u1C   \n",
      "4        0         Dua Lipa                Illusion  59xD5osEFsaNt5PXfIKUnX   \n",
      "5       10      Chris Brown           Go Girlfriend  7sDsbFNNQmG2UmRjHtO7fW   \n",
      "6       19      John Summit            EAT THE BASS  1ViErUfDfWkXPXTsjj3kyh   \n",
      "7       27       Larry June        Imported Couches  5YWyB1Unzq0sO6DBTqiVuw   \n",
      "8       16  Suki Waterhouse                  My Fun  306xT15GTuDs3NyopIANrh   \n",
      "9       12           WILLOW   b i g f e e l i n g s  0Xfkeu82ju4uni0CH2z9XN   \n",
      "\n",
      "   track_popularity               artist_id  artist_popularity  \\\n",
      "0                62  2HPaUgqeutzr3jx5a9WyDV                 79   \n",
      "1                62  7vXDAI8JwjW531ouMGbfcp                 78   \n",
      "2                61  4oLeXFyACqeem2VImYeBFe                 79   \n",
      "3                59  2LRoIwlKmHjgvigdNGBHNo                 91   \n",
      "4                57  6M2wZ9GZgrQXHCFfjv46we                 88   \n",
      "5                57  7bXgB6jMjp9ATFy66eO08Z                 87   \n",
      "6                51  7kNqXtgeIwFtelmRjWv205                 70   \n",
      "7                50  1grN0519h2zYqpRtYbDZAl                 64   \n",
      "8                49  5GGJosGMs08YEmKTZJe1fL                 69   \n",
      "9                48  3rWZHrfrsPBxVy692yAIxF                 71   \n",
      "\n",
      "                                       artist_genres  artist_followers  \\\n",
      "0                     [r&b, rap, urban contemporary]           6379963   \n",
      "1        [latin pop, latin viral pop, pop argentino]           7685227   \n",
      "2                        [edm, house, stutter house]           1392721   \n",
      "3  [colombian pop, pop reggaeton, reggaeton, regg...          10640880   \n",
      "4                           [dance pop, pop, uk pop]          43025907   \n",
      "5                                         [r&b, rap]          21319200   \n",
      "6                  [edm, house, pop dance, uk dance]            258946   \n",
      "7                                         [cali rap]            369659   \n",
      "8                                        [indie pop]            630774   \n",
      "9     [afrofuturism, pop, post-teen pop, pov: indie]           2495141   \n",
      "\n",
      "   index_y  ...  energy  loudness  speechiness  acousticness  \\\n",
      "0        0  ...   0.477    -8.028       0.0448       0.05830   \n",
      "1        1  ...   0.787    -4.586       0.0270       0.10400   \n",
      "2        2  ...   0.635    -9.001       0.1900       0.27500   \n",
      "3        3  ...   0.791    -2.367       0.1200       0.09030   \n",
      "4        4  ...   0.772    -4.721       0.0472       0.02770   \n",
      "5        5  ...   0.736    -6.043       0.0616       0.01670   \n",
      "6        6  ...   0.785    -6.510       0.0483       0.00226   \n",
      "7        7  ...   0.807    -8.000       0.3060       0.42600   \n",
      "8        8  ...   0.699    -5.217       0.1340       0.11500   \n",
      "9        9  ...   0.848    -4.298       0.0459       0.09070   \n",
      "\n",
      "   instrumentalness  liveness  valence    tempo  duration_ms  time_signature  \n",
      "0          0.000018     0.228    0.144  170.312       183991             4.0  \n",
      "1          0.000000     0.243    0.659  111.933       203114             4.0  \n",
      "2          0.411000     0.198    0.265  101.620       123608             4.0  \n",
      "3          0.000000     0.218    0.722  195.997       188600             4.0  \n",
      "4          0.000003     0.106    0.709  126.964       188143             4.0  \n",
      "5          0.000000     0.125    0.559  187.850       175566             4.0  \n",
      "6          0.009290     0.119    0.408  127.971       202500             4.0  \n",
      "7          0.000121     0.138    0.430   80.024       220500             4.0  \n",
      "8          0.002630     0.274    0.847  174.078       162291             4.0  \n",
      "9          0.000002     0.315    0.500  109.957       264133             1.0  \n",
      "\n",
      "[10 rows x 21 columns]\n",
      "Saved DataFrame successfully to csv file!\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n",
      "/var/folders/bs/_h1fsr8d6_g67rh2_kt902nm0000gn/T/ipykernel_79009/1303377768.py:66: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  tf_df = tf_df.append(feat, ignore_index=True)\n"
     ]
    }
   ],
   "source": [
    "playlist_new = '37i9dQZF1DX4JAvHpjipBk'\n",
    "new_april = get_top_tracks_from_playlist(playlist_new, sp)\n",
    "print(new_april.shape)\n",
    "print(new_april.head(10))\n",
    "new_april.to_csv('newTracksApril.csv')\n",
    "print('Saved DataFrame successfully to csv file!')"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
